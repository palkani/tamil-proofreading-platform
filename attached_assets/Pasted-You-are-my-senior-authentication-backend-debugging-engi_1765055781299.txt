You are my senior authentication & backend debugging engineer.  
I have a production issue with Supabase email sign-up + Google Sign-In on Cloud Run.

You must follow this deep debugging workflow.

===================
STEP 1 — Ask me for:
===================
1. The Supabase client initialization code (frontend + backend).
2. My Express session middleware configuration.
3. My PG/PostgreSQL connection configuration (especially SSL options).
4. My /auth/sync-session backend route code.
5. My /login and /dashboard route code where the error happens.
6. My Cloud Run environment variables for DATABASE_URL.
7. My Supabase project region.
8. The full log output from Cloud Run for the failed request.

Do NOT generate any fixes until I provide ALL of this information.

===================
STEP 2 — After I paste them:
===================
1. Analyze the logs precisely:
   - “unable to verify first certificate” → root cause?
   - “ERR_HTTP_HEADERS_SENT: Cannot set headers after they are sent” → where in code?
   - Why PGStore / session store fails?
   - Why Supabase sign-in redirects back to login?

2. Identify which root cause applies:
   • incorrect PostgreSQL SSL mode  
   • missing `ssl: { rejectUnauthorized: false }`  
   • Cloud Run CA cert missing  
   • double response in Express route  
   • view rendering after redirect  
   • session not persisted because PGStore fails  
   • Google callback URL mismatch  
   • Supabase redirect URL mismatch  

3. Produce a root-cause breakdown with:
   • Primary root cause  
   • Secondary contributing issues  
   • Exact code lines responsible  

===================
STEP 3 — FIXES (must follow these rules):
===================
1. Provide ONLY the minimal and correct patch — not full file rewrites.  
2. Provide:
   • The corrected PG connection config  
   • The corrected session middleware code  
   • The corrected Express route that sends headers twice  
3. Ensure production-safe SSL configuration.  
4. Ensure Cloud Run can connect to Supabase PostgreSQL without certificate issues.  
5. Ensure Google Sign-In callback properly creates Supabase session AND Express session.

===================
STEP 4 — VALIDATION
===================
1. Provide test cases to confirm session is created and persisted.  
2. Provide curl command to test /auth/sync-session.  
3. Provide browser test steps to confirm Google Sign-In succeeds.  
4. Provide Cloud Run logs to monitor after fix.

===================
STEP 5 — ASK AGAIN IF NEEDED
===================
If ANY information is missing, do not guess — ask me before generating fixes.

Now respond with:

“Paste:
1) Supabase client config (frontend + backend)
2) Express session middleware
3) PG connection config
4) /auth/sync-session code
5) /dashboard + /login routes
6) Cloud Run DATABASE_URL env
7) Supabase region and project reference
8) Full Cloud Run log excerpt” 
